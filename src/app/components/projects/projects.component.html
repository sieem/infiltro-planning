<div class="controls">
    <a [routerLink]="[ '/project/toevoegen' ]" class="btn red"><img src="/assets/images/icon-new.svg" alt=""> New project</a>
    <div class="btn filter status">
        <span class="title">Toon ook</span>
        <div class="dropdown">
            <div class="item" *ngFor="let status of projectService.statuses" (click)="changeFilter('status', status.type)">
                <ng-container *ngIf="status.filter">
                    <img src="/assets/images/icon-unchecked.svg" alt="" *ngIf="!activeFilter.status.includes(status.type)">
                    <img src="/assets/images/icon-checked.svg" alt="" *ngIf="activeFilter.status.includes(status.type)">
                    <span>{{status.name}}</span>
                </ng-container>
            </div>
        </div>
    </div>

    <div class="btn filter executor" *ngIf="auth.isAdmin()">
        <span class="title">Uitvoerder</span>
        <div class="dropdown">
            <div class="item" *ngFor="let executor of projectService.executors"
                (click)="changeFilter('executor', executor.type)">
                <img src="/assets/images/icon-unchecked.svg" alt=""
                    *ngIf="!activeFilter.executor.includes(executor.type)">
                <img src="/assets/images/icon-checked.svg" alt=""
                    *ngIf="activeFilter.executor.includes(executor.type)">
                <span>{{executor.name}}</span>
            </div>
        </div>
    </div>

    <div class="btn filter sort" [ngClass]="sortOptions.order">
        <span class="title">Sorteer</span>
        <!-- <img src="/assets/images/icon-unchecked.svg" alt=""> -->
        <div class="dropdown">
            <div class="item" *ngFor="let sortable of projectService.sortables" (click)="sortProjects(sortable.type)">
                <ng-container *ngIf="sortable.sort">
                    <img src="/assets/images/icon-unchecked.svg" alt="" *ngIf="sortOptions.field !== sortable.type">
                    <img src="/assets/images/icon-checked.svg" alt="" *ngIf="sortOptions.field === sortable.type">
                    <span>{{sortable.name}}</span>
                    <span *ngIf="sortOptions.field === sortable.type && sortOptions.order == 'desc'"> | desc</span>
                    <span *ngIf="sortOptions.field === sortable.type && sortOptions.order == 'asc'"> | asc</span>
                </ng-container>      
            </div>
        </div>
    </div>
    <div class="btn filter batch" *ngIf="auth.isAdmin()" (click)="toggleBatchMode()">
        <ng-container *ngIf="!batchMode; else elseTemplate">
            <span class="title">Batch mode</span>
        </ng-container>
        <ng-template #elseTemplate>
            <span class="title">Pas projecten aan</span>
        </ng-template>
        
        
    </div>
</div>

<div class="projectList">
    <ng-container *ngIf="projects.length > 0; else noProjectsFound">
        <div class="project" *ngFor="let project of projects" [ngClass]="[project.status, isSelected(project)]" (click)="selectProject(project)">
            <div class="company">{{companyService.companyName(project.company)}} </div>
            <ng-container *ngIf="!batchMode; else noBatchMode">
                <div class="title" [routerLink]="[ '/project', project._id ]">{{ project.projectName }} /
                    {{ projectService.projectTypeName(project.projectType) }} / {{project.houseAmount}}</div>
            </ng-container>
            <ng-template #noBatchMode>
                <div class="title">{{ project.projectName }} /
                    {{ projectService.projectTypeName(project.projectType) }} / {{project.houseAmount}}</div>
            </ng-template>
            
            
            <div class="status">{{projectService.statusName(project.status)}}</div>
            <div class="address">{{project.street}}, {{project.postalCode}} {{project.city}}, <span class="extraInfoAddress">{{project.extraInfoAddress}}</span></div>
            <div class="dateHourCreated">{{ projectService.formatDate(project.dateCreated) }}</div>
            <div class="dateHourPlanned">{{ projectService.executorName(project.executor) }} op<br>{{ projectService.formatDate(project.datePlanned) }}<br>om {{ project.hourPlanned }}</div>
            <div class="technicalDataFilledIn">
                <ng-container *ngIf="projectService.isTechnicalDataFilledIn(project); else technicalDataNotFilledIn">
                    <img src="/assets/images/icon-okay.svg" alt="">
                </ng-container>
                <ng-template #technicalDataNotFilledIn>
                    <img src="/assets/images/icon-not-okay.svg" alt="">
                </ng-template>
                
            </div>
        </div>
    </ng-container>
    <ng-template #noProjectsFound>
        <div class="empty">
            <img src="/assets/images/icon-broken-house.svg" alt="broken house">            
            <span>Geen projecten gevonden :(</span>
        </div>
    </ng-template>
</div>
